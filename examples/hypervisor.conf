# wire hypervisor configuration
# KVM/libvirt host with multiple VM bridges

# =============================================================================
# Management Interface
# =============================================================================

interface eth0 set state up
interface eth0 address 10.0.0.50/24
route default via 10.0.0.1

# =============================================================================
# VM Traffic - Bonded with VLANs
# =============================================================================

# Create bond for VM traffic (high availability)
bond bond0 create mode active-backup
bond bond0 add eth1
bond bond0 add eth2
interface bond0 set state up
interface bond0 set mtu 9000

# Production VLAN
vlan 100 on bond0
interface bond0.100 set state up
interface bond0.100 set mtu 9000

# Development VLAN
vlan 200 on bond0
interface bond0.200 set state up
interface bond0.200 set mtu 9000

# Storage VLAN (jumbo frames for iSCSI/NFS)
vlan 300 on bond0
interface bond0.300 set state up
interface bond0.300 set mtu 9000
interface bond0.300 address 10.30.0.50/24

# =============================================================================
# VM Bridges
# =============================================================================

# Production VM bridge
bridge br-prod create
bridge br-prod add bond0.100
interface br-prod set state up

# Development VM bridge
bridge br-dev create
bridge br-dev add bond0.200
interface br-dev set state up
interface br-dev address 10.20.0.1/24

# Isolated VM bridge (no physical uplink)
bridge br-isolated create
interface br-isolated set state up
interface br-isolated address 192.168.255.1/24

# =============================================================================
# Storage Network
# =============================================================================

# Direct route to storage array
route 10.30.0.0/24 dev bond0.300
